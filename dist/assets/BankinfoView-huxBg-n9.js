import{_ as Be,r as s,x as F,w as de,e as Le,j as y,c as p,m as o,l as n,g as _,y as L,z as Ce,A as ce,k as i,o as u,a as l,p as v,B as V,C as ve,I as Ue,D as ze}from"./index-BqZfhdqq.js";import{P as je}from"./price-DxBLIrVz.js";import{T as W}from"./trade-DvEvm-Iy.js";import{x as me}from"./persian-tools.esm-CBI2Czng.js";const Me={class:"d-card asset"},Ne={class:"d-flex justify-space-between align-center w-100"},Ge={class:"d-flex flex-column justify-space-between h-100 align-end"},qe={key:1,class:"price my-1"},Ee={key:3,class:"gold-price my-1"},$e={class:"action"},Fe={class:"d-flex flex-column h-100 w-100"},Re={class:"asset-card mb-3"},Ke={class:"d-flex flex-column justify-space-between h-100 align-end"},Oe={key:1,class:"gold-weight my-1"},He={key:3,class:"gold-price my-1"},Je={class:"amount-card"},Qe={class:"d-flex justify-space-between"},Xe={key:1,class:"price my-1"},Ye={class:"d-flex justify-space-between mt-2"},Ze={key:1,class:"price my-1"},et={class:"d-flex justify-space-between mt-2"},tt={key:1,class:"price my-1"},at={class:"trade-history"},lt={class:"d-flex justify-space-between"},st={class:""},ot={class:""},nt={key:0},ut={class:"amount-word"},rt={class:"title my-2"},it={key:0},dt={class:"amount-word"},ct={class:"successModal-content py-5"},vt={__name:"BankinfoView",setup(mt){const R=Ce();s(!1);const C=s(""),f=s(""),r=s(!1),pe=s(!1),I=s(null),w=s(!1),S=s(!1),D=s(null),K=s(),O=s(),g=s(!1),H=s(!1),U=s(!1),z=s([]),P=s(!1),k=s(!1),d=s(""),c=s(""),j=s(""),fe=s(!1),ge=s(""),A=s(!1),J=s(""),ye=s([{text:"همه",value:""},{text:"موفق",value:"completed"},{text:"ناموفق",value:"failed"},{text:"نامشخص",value:"pending"}]),Q=s([{title:"تاریخ",key:"date"},{title:"زمان",key:"time"},{title:"مقدار(تومان)",key:"amount"},{title:"وضعیت",key:"status"}]),m=s({balance:0,goldWeight:0,goldprice:0,TotalAssets:0,blocked:0,goldBlock:0}),x=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),h=s({sellPrice:"",buyPrice:"",change:""}),T=s({type:"",status:""}),X=s(""),M=s({}),Y=async()=>{try{g.value=!0;const e=await ce.Wallet();return m.value.balance=e.balance,m.value.goldWeight=e.goldWeight,m.value.TotalAssets=e.totalAssets,m.value.blocked=e.blocked,m.value.goldBlock=e.goldBlock,e}catch(e){e.response.status==401&&(localStorage.clear(),y.replace("/Login")),f.value=e.response.data.msg||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{g.value=!1}},_e=async()=>{try{H.value=!0;const e=await je.GoldPrice();return h.value.buyPrice=e.buyPrice,h.value.sellPrice=e.sellPrice,h.value.change=e.change,e}catch(e){e.response.status==401&&(localStorage.clear(),y.replace("/Login")),f.value=e.response.data.msg||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{H.value=!1}},be=async()=>{try{const e=await W.DepositWallet(d.value.replaceAll(",",""),D.value);return X.value=e.url,window.location.href=X.value,e}catch(e){e.response.status==401&&(localStorage.clear(),y.replace("/Login")),f.value=e.response.data.msg||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{}},we=async e=>{try{const t=await W.VerifyDepositWallet(e);return M.value=t,t}catch(t){f.value=t.response.data.msg||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{}},xe=async()=>{try{U.value=!0;const e=await W.WithdrawWallet(c.value.replaceAll(",",""),C.value);return k.value=!1,J.value=`مبلغ ${c.value} پس از تایید کارشناس طی 72 ساعت آینده به حساب شما واریز خواهد شد.`,A.value=!0,setTimeout(()=>{A.value=!1},1e4),Y(),G(),e}catch(e){e.response.status==401&&(localStorage.clear(),y.replace("/Login")),f.value=e.response.data.msg||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{U.value=!1}},Z=[e=>!!e||"مقدار ورودی نمی‌تواند خالی باشد",e=>/^\d+$/.test(e.replace(/,/g,""))||"فقط عدد مجاز است"],N=F(()=>parseFloat(d.value.replace(/,/g,""))>=1e5),Ve=()=>{d.value=d.value.replace(/\D/g,""),d.value.length>10&&(d.value=d.value.slice(0,11)),d.value=ee(d.value)},ke=()=>{c.value=c.value.replace(/\D/g,""),c.value.length>10&&(c.value=c.value.slice(0,11)),c.value=ee(c.value)},ee=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),te=async()=>{try{T.value.type="deposit",w.value=!0;const e=await W.WalletTransaction(T.value);return K.value=e,e}catch(e){e.response.status==401&&(localStorage.clear(),y.replace("/Login")),f.value=e.response.data.msg||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{w.value=!1}},G=async()=>{try{T.value.type="withdraw",w.value=!0;const e=await W.WalletTransaction(T.value);return O.value=e,e}catch(e){e.response.status==401&&(localStorage.clear(),y.replace("/Login")),f.value=e.response.data.msg||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{w.value=!1}},he=async()=>{try{S.value=!0;const e=await ce.GetCarts();return z.value=e.data.bankAccounts,e}catch(e){e.response.status==401&&(localStorage.clear(),y.replace("/Login")),f.value=e.response.data.msg||"خطایی رخ داده است!",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}finally{S.value=!1}},Te=e=>{T.value.status=e.value,te(),G()},We=F(()=>{if(c.value){const e=c.value.replace(/,/g,""),t=parseInt(e,10);return t<1?"کمتر از یک تومان":me(Math.floor(t))+" تومان"}return""}),Ie=F(()=>{if(d.value){const e=d.value.replace(/,/g,""),t=parseInt(e,10);return t<1?"کمتر از یک تومان":me(Math.floor(t))+" تومان"}return""});return de(k,e=>{e||(c.value="")}),de(P,e=>{e||(d.value="")}),Le(()=>{Y(),_e(),te(),G(),he();const e=s({authority:R.query.Authority,status:R.query.Status});e.value.authority&&e.value.status&&(we(e.value),e.value.status==="OK"?y.push({name:"success",query:M.value}):y.push({name:"failed",query:M.value}))}),(e,t)=>{const b=i("v-progress-circular"),B=i("v-btn"),q=i("v-col"),ae=i("v-tab"),Se=i("v-tabs"),De=i("v-combobox"),le=i("v-chip"),se=i("v-data-table"),oe=i("v-tabs-window-item"),Pe=i("v-tabs-window"),Ae=i("v-row"),ne=i("v-alert"),ue=i("v-text-field"),re=i("v-select"),ie=i("v-form"),E=i("v-card"),$=i("v-dialog");return u(),p("div",null,[o(Ae,{class:"mt-5"},{default:n(()=>[o(q,{cols:"12",md:"6"},{default:n(()=>[l("div",Me,[l("div",Ne,[t[13]||(t[13]=l("p",{class:"text"},"موجودی کیف پول :",-1)),l("div",Ge,[g.value?(u(),_(b,{key:0,size:10,color:"#fff",indeterminate:""})):(u(),p("p",qe,v(x(m.value.balance))+" تومان ",1)),g.value?(u(),_(b,{key:2,size:10,color:"#fff",indeterminate:""})):(u(),p("p",Ee," معادل "+v((m.value.balance/h.value.buyPrice).toFixed(2))+" گرم طلا ",1))])]),l("div",$e,[o(B,{variant:"flat",color:"#00603A",class:"wallet-btn",onClick:t[0]||(t[0]=a=>P.value=!0)},{default:n(()=>t[14]||(t[14]=[V("شارژ کیف پول")])),_:1}),o(B,{variant:"outlined",color:"#00603A",class:"wallet-btn",onClick:t[1]||(t[1]=a=>k.value=!0)},{default:n(()=>t[15]||(t[15]=[V("برداشت")])),_:1})])])]),_:1}),o(q,{cols:"12",md:"6"},{default:n(()=>[l("div",Fe,[l("div",Re,[t[16]||(t[16]=l("p",{class:"text"},"موجودی صندوق طلا :",-1)),l("div",Ke,[g.value?(u(),_(b,{key:0,size:10,color:"#fff",indeterminate:""})):(u(),p("p",Oe,v(m.value.goldWeight)+" گرم",1)),g.value?(u(),_(b,{key:2,size:10,color:"#fff",indeterminate:""})):(u(),p("p",He," معادل "+v(x(+(m.value.goldWeight*h.value.buyPrice).toFixed()))+"تومان ",1))])]),l("div",Je,[l("div",Qe,[t[17]||(t[17]=l("p",{class:"text"},"دارایی کل",-1)),g.value?(u(),_(b,{key:0,size:10,color:"#fff",indeterminate:""})):(u(),p("p",Xe,v(x(m.value.TotalAssets))+" تومان ",1))]),l("div",Ye,[t[18]||(t[18]=l("p",{class:"text"},"در انتظار پرداخت",-1)),g.value?(u(),_(b,{key:0,size:10,color:"#fff",indeterminate:""})):(u(),p("p",Ze,v(x(m.value.blocked))+" تومان ",1))]),l("div",et,[t[19]||(t[19]=l("p",{class:"text"},"در صف انتقال",-1)),g.value?(u(),_(b,{key:0,size:10,color:"#fff",indeterminate:""})):(u(),p("p",tt,v(m.value.goldBlock)+" گرم",1))])])])]),_:1}),o(q,{cols:"12"},{default:n(()=>[t[23]||(t[23]=l("h3",{class:"transaction-title"},"تاریخچه تراکنش ها",-1)),l("div",at,[l("div",lt,[o(Se,{modelValue:I.value,"onUpdate:modelValue":t[2]||(t[2]=a=>I.value=a),"bg-color":"white"},{default:n(()=>[o(ae,{value:"one"},{default:n(()=>t[20]||(t[20]=[V("واریز")])),_:1}),o(ae,{value:"two"},{default:n(()=>t[21]||(t[21]=[V("برداشت")])),_:1})]),_:1},8,["modelValue"]),o(De,{label:"وضعیت پرداخت",items:ye.value,"item-title":"text","item-value":"value",density:"comfortable",variant:"solo",class:"transaction-filter","onUpdate:modelValue":Te},null,8,["items"])]),o(Pe,{modelValue:I.value,"onUpdate:modelValue":t[3]||(t[3]=a=>I.value=a)},{default:n(()=>[o(oe,{value:"one",class:"transaction-box"},{default:n(()=>[t[22]||(t[22]=l("div",{class:"d-flex justify-end"},null,-1)),o(se,{headers:Q.value,items:K.value,loading:w.value,class:"transaction-table"},{"item.status":n(({item:a})=>[l("div",st,[o(le,{text:a.status=="completed"?"موفق":a.status=="pending"?"نامشخص":"ناموفق",color:a.status=="completed"?"green":a.status=="pending"?"#666666":"red",size:"small"},null,8,["text","color"])])]),"item.amount":n(({item:a})=>[l("p",null,v(x(a.amount)),1)]),_:1},8,["headers","items","loading"])]),_:1}),o(oe,{value:"two",class:"transaction-box"},{default:n(()=>[o(se,{headers:Q.value,items:O.value,loading:w.value,class:"transaction-table"},{"item.status":n(({item:a})=>[l("div",ot,[o(le,{text:a.status=="completed"?"موفق":a.status=="pending"?"در انتظار":"ناموفق",color:a.status=="completed"?"green":a.status=="pending"?"#666666":"red",size:"small"},null,8,["text","color"])])]),"item.amount":n(({item:a})=>[l("p",null,v(x(a.amount)),1)]),_:1},8,["headers","items","loading"])]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1}),r.value?(u(),_(ne,{key:0,color:"error",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:n(()=>[V(v(f.value),1)]),_:1})):L("",!0),pe.value?(u(),_(ne,{key:1,color:"success",border:"bottom",elevation:"2",class:"k-alert alert-animatiton",closable:""},{default:n(()=>[V(v(ge.value),1)]),_:1})):L("",!0),o($,{modelValue:P.value,"onUpdate:modelValue":t[7]||(t[7]=a=>P.value=a),width:"500"},{default:n(()=>[o(E,{class:"cart-Dialog"},{default:n(()=>[t[25]||(t[25]=l("div",{class:"my-1"},[l("p",null,"مبلغ مورد نظر را جهت واریز وارد نمایید")],-1)),o(ie,{ref:"form",modelValue:N.value,"onUpdate:modelValue":t[6]||(t[6]=a=>N.value=a),onSubmit:ve(be,["prevent"])},{default:n(()=>[o(ue,{modelValue:d.value,"onUpdate:modelValue":t[4]||(t[4]=a=>d.value=a),variant:"outlined",color:"rgba(135, 104, 36, 1)",density:"compact",label:"مبلغ (تومان)",class:"mb-0 mt-2",rules:Z,onInput:Ve},null,8,["modelValue"]),d.value?(u(),p("div",nt,[l("p",ut,v(Ie.value),1)])):L("",!0),o(re,{modelValue:D.value,"onUpdate:modelValue":t[5]||(t[5]=a=>D.value=a),loading:S.value,label:"انتخاب کارت",items:z.value,density:"compact",variant:"outlined","item-title":"cardNumber","item-value":"id",class:"mt-3",rules:[a=>!!a||"لطفا کارت خود را انتخاب کنید"]},null,8,["modelValue","loading","items","rules"]),l("div",rt,[o(Ue),t[24]||(t[24]=l("p",null,"حداقل مبلغ شارژ باید 100,000 تومان باشد",-1))]),o(B,{type:"submit",text:"شارژ حساب",block:"",color:"#9D7E3B",variant:"flat",class:"submit-cart-btn",disabled:!N.value||!D.value,loading:fe.value},null,8,["disabled","loading"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),o($,{modelValue:k.value,"onUpdate:modelValue":t[11]||(t[11]=a=>k.value=a),width:"500"},{default:n(()=>[o(E,{class:"cart-Dialog"},{default:n(()=>[t[26]||(t[26]=l("div",{class:"title my-1"},[l("p",null,"مبلغ مورد نظر را جهت برداشت وارد نمایید")],-1)),o(ie,{ref:"form",modelValue:j.value,"onUpdate:modelValue":t[10]||(t[10]=a=>j.value=a),onSubmit:ve(xe,["prevent"])},{default:n(()=>[o(ue,{modelValue:c.value,"onUpdate:modelValue":t[8]||(t[8]=a=>c.value=a),variant:"outlined",color:"rgba(135, 104, 36, 1)",density:"compact",label:"مبلغ (تومان)",class:"mb-0 mt-2",rules:Z,onInput:ke},null,8,["modelValue"]),c.value?(u(),p("div",it,[l("p",dt,v(We.value),1)])):L("",!0),o(re,{modelValue:C.value,"onUpdate:modelValue":t[9]||(t[9]=a=>C.value=a),loading:S.value,label:"انتخاب کارت",items:z.value,density:"compact",variant:"outlined","item-title":"cardNumber","item-value":"id",class:"mt-3",rules:[a=>!!a||"لطفا کارت خود را انتخاب کنید"]},null,8,["modelValue","loading","items","rules"]),o(B,{type:"submit",text:"برداشت از حساب",block:"",color:"#9D7E3B",variant:"flat",class:"submit-cart-btn",disabled:!j.value,loading:U.value},null,8,["disabled","loading"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),o($,{"max-width":"500",modelValue:A.value,"onUpdate:modelValue":t[12]||(t[12]=a=>A.value=a),class:"trade-modal"},{default:n(()=>[o(E,{class:"success-modal"},{default:n(()=>[l("div",ct,[t[27]||(t[27]=l("h3",null,"تایید فاکتور کیف پول",-1)),t[28]||(t[28]=l("img",{src:ze,alt:"قبت کارت",width:"200",height:"200"},null,-1)),l("p",null,v(J.value),1)])]),_:1})]),_:1},8,["modelValue"])])}}},_t=Be(vt,[["__scopeId","data-v-d76618a0"]]);export{_t as default};
